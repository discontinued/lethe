dist: xenial
addons:
  apt:
    packages:
    - dirmngr
before_install:
- npm install -g npm recce
install: npm install
script:
- "./manage trust-escapace"
- npm run typecheck
- npm run lint
- npm run test
- npm run build
after_success:
- npx codecov
language: node_js
branches:
  only:
  - master
  - next
  - "/^renovate.*$/"
  - "/^new-.*$/"
  - "/^feat-.*$/"
  - "/^add-.*$/"
  - "/^change-.*$/"
  - "/^breaking-.*$/"
  - "/^deprecate-.*$/"
  - "/^remove-.*$/"
  - "/^fix-.*$/"
  - "/^sec-.*$/"
  - "/^security-.*$/"
  - "/^perf-.*$/"
  - "/^performance-.*$/"
  - "/^test-.*$/"
  - "/^tests-.*$/"
  - "/^chore-.*$/"
  - "/^docs-.*$/"
  - "/^style-.*$/"
  - "/^refactor-.*$/"
  - "/^v?\\d+\\.\\d+\\.\\d+.*$/"
  - "/^\\d+\\.\\d+\\.\\d+.*$/"
cache:
  directories:
  - "$HOME/.npm"
notifications:
  email: false
node_js:
- node
jobs:
  include:
  - stage: release
    node_js: lts/*
    deploy:
      provider: script
      skip_cleanup: true
      script:
      - npx semantic-release
env:
  global:
  - secure: G+6REInfYwdxo5nSUMRonNK2KG59XWyCeY14U4DxkVQmqSzepckrvpwMaikVwDA5lGiLG+3GyfHz6+fhPWGTWGON90UZNZoNj4IOeXK3TW/U1ioMefvBtWykT8KzXvAePu0Rb6/EmEpahXuHR/X1b9IpYCOaP/ct2ytEkN5Bk/YtuAMm2d0hB/6yKLS+UFXCJLw48zmtQE0kD4E9gh4joisY8V5PNL9yYfgUCGMY8IzwZXTHqNOx0DVXTyMXj0cr3CKqSQkvVTKlzCG57zL/valbr6sMO9QbGT96HNV2khrMOkMW2RNcOlB/x+uXI0crKbr7f+pY98ltcUOTBTjT1WB7JdUoe0dB50xDnY5gsNnaAH/M12+miWQ6EIfW/SBr8zjd5BDkqMWwlG/40oSultB1f8XJkHL+f6qL+CerGJLpETLrVvAkCrZoZKFkS5iEZFYKNQ/wABsjMcpn2tS5GGCNRmM/LFB9Suf+6W3NIEag68IDQvyxVZ6/jgNDS0/VJfzR8rHEmM58dlByn1Id3WNXNPqJI9EWyxFJDAIeMWz8Dzls5NpcXAN0Fn4SfBxDJLngFwUNA9Ql0X9UezrAXwazR5tjARjCKFEWgky3YOzaO/0uGvBS4R8pNapOgexMabEj88HZ5cgmsdJ9lgzIoRvZp4Go73z7Eyl/Q1SwYws=
  - secure: B/0c4W+u47+FFy5pqllbam3fJm7viFoCw54R1mDPPUlj/NAZLChsaBw9XS++v1NxbFv6fD546AiUqo7adUv/RjLYLW6c1jzPrJqCTesBVRlbnQRld16tOpfu/cMHfQOdhbtF4CBLDfmWUUHJp7KACs9Ebgz9ULX/npZrlyQOnzvL716dTReM8QehInZiBqq/MSJ6b5KjTPWdN7ljo2HnW0nBhEnNoFqP852SfTrWsnPqK/5UHpJcg8hDCEThuXtb14kOyUz3Gp0YUBnDEIL3VEKjIPRN+x7G1T2qOJyv/QuEJ9RcjrI2x/l6CeQNJJ/JLNrrtVpvGjcT2cFjrEsjHgJBL7vdEBMrq3UFCPByZ7ReZNupy4igjE2fWkDVPqvh3ZY/j9WLuTvbFK/62dEEYFC0tUyyy1w4nrtkVTZUNuUHyC6VJZwTNF5o3zJjqrzE8rWkMU3y/to5ppNkWjGrKQ+AY+NnUEVnO2xhXixLd1LTOpU7RVN2DxEZScrl37H5M1OGEPwfA47y8O8eli3/5WggroMcBwTdSiajiVol8+qxpcaeVlDlkRQL1ouJ1nO1s2GnDF4szyz01hln1Rky/Z8a4kfVWEut9bjvDcRRcLxqYNTshIx+wyIF6hud1lwdpedCN6UOk3IObGgolsotf3GRwknQEn1KFkvMiBmPjQk=
